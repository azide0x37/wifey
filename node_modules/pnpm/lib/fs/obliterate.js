require('../promise');
var rimraf = require('thenify')(require('rimraf'));
var fs = require('mz/fs');

/*
 * Removes `path`.
 * If it's a symlink, remove its destination as well.
 */

module.exports = function obliterate(path) {
  return fs.lstat(path).then(function (stat) {
    if (stat.isSymbolicLink()) {
      return fs.readlink(path).then(function (realpath) {
        return rimraf(realpath);
      });
    } else {
      return rimraf(path);
    }
  }).catch(function (err) {
    if (err.code !== 'ENOENT') throw err;
  });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYn4vZnMvb2JsaXRlcmF0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFRLFlBQVI7QUFDQSxJQUFJLFNBQVMsUUFBUSxTQUFSLEVBQW1CLFFBQVEsUUFBUixDQUFuQixDQUFiO0FBQ0EsSUFBSSxLQUFLLFFBQVEsT0FBUixDQUFUOzs7Ozs7O0FBT0EsT0FBTyxPQUFQLEdBQWlCLFNBQVMsVUFBVCxDQUFxQixJQUFyQixFQUEyQjtBQUMxQyxTQUFPLEdBQUcsS0FBSCxDQUFTLElBQVQsRUFDSixJQURJLENBQ0MsZ0JBQVE7QUFDWixRQUFJLEtBQUssY0FBTCxFQUFKLEVBQTJCO0FBQ3pCLGFBQU8sR0FBRyxRQUFILENBQVksSUFBWixFQUNKLElBREksQ0FDQztBQUFBLGVBQVksT0FBTyxRQUFQLENBQVo7QUFBQSxPQURELENBQVA7QUFFRCxLQUhELE1BR087QUFDTCxhQUFPLE9BQU8sSUFBUCxDQUFQO0FBQ0Q7QUFDRixHQVJJLEVBU0osS0FUSSxDQVNFLGVBQU87QUFDWixRQUFJLElBQUksSUFBSixLQUFhLFFBQWpCLEVBQTJCLE1BQU0sR0FBTjtBQUM1QixHQVhJLENBQVA7QUFZRCxDQWJEIiwiZmlsZSI6Im9ibGl0ZXJhdGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi9wcm9taXNlJylcbnZhciByaW1yYWYgPSByZXF1aXJlKCd0aGVuaWZ5JykocmVxdWlyZSgncmltcmFmJykpXG52YXIgZnMgPSByZXF1aXJlKCdtei9mcycpXG5cbi8qXG4gKiBSZW1vdmVzIGBwYXRoYC5cbiAqIElmIGl0J3MgYSBzeW1saW5rLCByZW1vdmUgaXRzIGRlc3RpbmF0aW9uIGFzIHdlbGwuXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBvYmxpdGVyYXRlIChwYXRoKSB7XG4gIHJldHVybiBmcy5sc3RhdChwYXRoKVxuICAgIC50aGVuKHN0YXQgPT4ge1xuICAgICAgaWYgKHN0YXQuaXNTeW1ib2xpY0xpbmsoKSkge1xuICAgICAgICByZXR1cm4gZnMucmVhZGxpbmsocGF0aClcbiAgICAgICAgICAudGhlbihyZWFscGF0aCA9PiByaW1yYWYocmVhbHBhdGgpKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJpbXJhZihwYXRoKVxuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICBpZiAoZXJyLmNvZGUgIT09ICdFTk9FTlQnKSB0aHJvdyBlcnJcbiAgICB9KVxufVxuIl19