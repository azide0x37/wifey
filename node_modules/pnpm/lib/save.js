var writeFile = require('mz/fs').writeFile;
var requireJson = require('./fs/require_json');
var sortedObject = require('sorted-object');

module.exports = function save(pkg, installedPackages, saveType, useExactVersion) {
  var packageJson = requireJson(pkg.path);
  packageJson[saveType] = packageJson[saveType] || {};
  installedPackages.forEach(function (dependency) {
    var semverCharacter = useExactVersion ? '' : '^';
    packageJson[saveType][dependency.spec.name] = semverCharacter + dependency.version;
  });
  packageJson[saveType] = sortedObject(packageJson[saveType]);

  return writeFile(pkg.path, JSON.stringify(packageJson, null, 2) + '\n', 'utf8');
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2xpYn4vc2F2ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFJLFlBQVksUUFBUSxPQUFSLEVBQWlCLFNBQWpDO0FBQ0EsSUFBSSxjQUFjLFFBQVEsbUJBQVIsQ0FBbEI7QUFDQSxJQUFJLGVBQWUsUUFBUSxlQUFSLENBQW5COztBQUVBLE9BQU8sT0FBUCxHQUFpQixTQUFTLElBQVQsQ0FBZSxHQUFmLEVBQW9CLGlCQUFwQixFQUF1QyxRQUF2QyxFQUFpRCxlQUFqRCxFQUFrRTtBQUNqRixNQUFJLGNBQWMsWUFBWSxJQUFJLElBQWhCLENBQWxCO0FBQ0EsY0FBWSxRQUFaLElBQXdCLFlBQVksUUFBWixLQUF5QixFQUFqRDtBQUNBLG9CQUFrQixPQUFsQixDQUEwQixVQUFVLFVBQVYsRUFBc0I7QUFDOUMsUUFBSSxrQkFBa0Isa0JBQWtCLEVBQWxCLEdBQXVCLEdBQTdDO0FBQ0EsZ0JBQVksUUFBWixFQUFzQixXQUFXLElBQVgsQ0FBZ0IsSUFBdEMsSUFBOEMsa0JBQWtCLFdBQVcsT0FBM0U7QUFDRCxHQUhEO0FBSUEsY0FBWSxRQUFaLElBQXdCLGFBQWEsWUFBWSxRQUFaLENBQWIsQ0FBeEI7O0FBRUEsU0FBTyxVQUFVLElBQUksSUFBZCxFQUFvQixLQUFLLFNBQUwsQ0FBZSxXQUFmLEVBQTRCLElBQTVCLEVBQWtDLENBQWxDLElBQXVDLElBQTNELEVBQWlFLE1BQWpFLENBQVA7QUFDRCxDQVZEIiwiZmlsZSI6InNhdmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgd3JpdGVGaWxlID0gcmVxdWlyZSgnbXovZnMnKS53cml0ZUZpbGVcbnZhciByZXF1aXJlSnNvbiA9IHJlcXVpcmUoJy4vZnMvcmVxdWlyZV9qc29uJylcbnZhciBzb3J0ZWRPYmplY3QgPSByZXF1aXJlKCdzb3J0ZWQtb2JqZWN0JylcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzYXZlIChwa2csIGluc3RhbGxlZFBhY2thZ2VzLCBzYXZlVHlwZSwgdXNlRXhhY3RWZXJzaW9uKSB7XG4gIHZhciBwYWNrYWdlSnNvbiA9IHJlcXVpcmVKc29uKHBrZy5wYXRoKVxuICBwYWNrYWdlSnNvbltzYXZlVHlwZV0gPSBwYWNrYWdlSnNvbltzYXZlVHlwZV0gfHwge31cbiAgaW5zdGFsbGVkUGFja2FnZXMuZm9yRWFjaChmdW5jdGlvbiAoZGVwZW5kZW5jeSkge1xuICAgIHZhciBzZW12ZXJDaGFyYWN0ZXIgPSB1c2VFeGFjdFZlcnNpb24gPyAnJyA6ICdeJ1xuICAgIHBhY2thZ2VKc29uW3NhdmVUeXBlXVtkZXBlbmRlbmN5LnNwZWMubmFtZV0gPSBzZW12ZXJDaGFyYWN0ZXIgKyBkZXBlbmRlbmN5LnZlcnNpb25cbiAgfSlcbiAgcGFja2FnZUpzb25bc2F2ZVR5cGVdID0gc29ydGVkT2JqZWN0KHBhY2thZ2VKc29uW3NhdmVUeXBlXSlcblxuICByZXR1cm4gd3JpdGVGaWxlKHBrZy5wYXRoLCBKU09OLnN0cmluZ2lmeShwYWNrYWdlSnNvbiwgbnVsbCwgMikgKyAnXFxuJywgJ3V0ZjgnKVxufVxuIl19